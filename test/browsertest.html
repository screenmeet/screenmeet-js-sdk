<!DOCTYPE html>
<html>
<head>
    <title>Hello</title>
    <script src="../build/bundle.js"></script>

</head>
<body>
Hello <div id="userinfo"></div>
<br/><br/>
<button onClick="doLogin()">Log in</button>
<button onClick="doLogout()">Log out</button>


<script>
  let opts = {"persistSession" : true,
    eventHandlers:{
      authenticated: updateUserInfo,
      signout: updateUserInfo
    }};

  let SM = window.SM = new ScreenMeet(opts);
  SM.api.setBaseUrl('https://ea-home-dev.screenmeet.com:3002/v3');

  async function  doLogin() {

    let cburl = 'https://ea-home-dev.screenmeet.com:3056/test/oauth_cb.html';
    let provider = 'zendesk';
    let instance = 'https://screenmeetdev.zendesk.com'

    try {
      let result = await SM.login(provider, cburl, instance);
      console.log(result);
    } catch (er) {
      console.log('login failed');
      console.error(er);
    }
  }

  async function doLogout() {
    if (!SM.isAuthenticated) {
      console.log('signout: User is not signed in, nothing to do');
      return;
    }

    SM.signout();

  }

  /**
   * Basic function that updates user name list
   */
  function updateUserInfo(userInfo) {
    let infoElement = document.getElementById('userinfo');
    if (userInfo && userInfo.user) {
      infoElement.innerHTML = JSON.stringify(userInfo.user);
    } else {
      infoElement.innerText = 'Unauthenticated user';
    }
  }

</script>

</body>
</html>